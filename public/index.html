<!DOCTYPE html>
<html>
<head>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@900&display=swap" rel="stylesheet">
    <style>
        body { background: transparent; margin: 0; padding: 20px; font-family: 'Roboto', sans-serif; color: white; text-transform: uppercase; overflow: hidden; }
        .board { display: flex; flex-direction: column; width: fit-content; min-width: 600px; filter: drop-shadow(0 8px 10px rgba(0,0,0,0.5)); }
        .row { display: flex; height: 55px; margin-bottom: 2px; align-items: center; }
        .info { flex: 1; min-width: 300px; display: flex; align-items: center; padding: 0 20px; font-size: 24px; transition: background 0.5s; }
        .logo { width: 38px; height: 38px; margin-right: 15px; object-fit: contain; }
        .sets-area { display: flex; background: #0b1422; height: 100%; }
        .set-box { width: 55px; display: flex; align-items: center; justify-content: center; font-size: 22px; border-left: 1px solid rgba(255,255,255,0.1); color: #ccc; }
        .current { width: 75px; background: #1a2a44; color: #fff; font-size: 34px; font-weight: bold; border-left: 2px solid rgba(255,255,255,0.2); }
        .footer { background: #0b1422; height: 38px; display: flex; align-items: center; padding: 0 20px; font-size: 16px; border-top: 1px solid #333; justify-content: space-between; }
    </style>
</head>
<body>
    <div class="board">
        <div class="row">
            <div class="info" id="bg-h"><img id="logo-h" class="logo"><span id="txt-h"></span></div>
            <div class="sets-area" id="sets-h-row"></div>
            <div class="set-box current" id="pts-h">0</div>
        </div>
        <div class="row">
            <div class="info" id="bg-a"><img id="logo-a" class="logo"><span id="txt-a"></span></div>
            <div class="sets-area" id="sets-a-row"></div>
            <div class="set-box current" id="pts-a">0</div>
        </div>
        <div class="footer">
            <span id="txt-tournament"></span>
            <span id="timer" style="font-family: monospace; font-size: 20px;">00:00</span>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        socket.on('update', s => {
            document.getElementById('txt-tournament').innerText = s.tournamentName;
            document.getElementById('txt-h').innerText = s.homeName;
            document.getElementById('txt-a').innerText = s.awayName;
            document.getElementById('bg-h').style.backgroundColor = s.homeColor;
            document.getElementById('bg-a').style.backgroundColor = s.awayColor;
            document.getElementById('pts-h').innerText = s.homeScore;
            document.getElementById('pts-a').innerText = s.awayScore;
            
            // Logos
            if(s.homeLogo) { document.getElementById('logo-h').src = s.homeLogo; document.getElementById('logo-h').style.display='block'; }
            else document.getElementById('logo-h').style.display='none';
            if(s.awayLogo) { document.getElementById('logo-a').src = s.awayLogo; document.getElementById('logo-a').style.display='block'; }
            else document.getElementById('logo-a').style.display='none';

            // Dibujar historial
            renderHistory(s.homeSetsHistory, 'sets-h-row');
            renderHistory(s.awaySetsHistory, 'sets-a-row');
        });

        socket.on('tick', d => document.getElementById('timer').innerText = format(d.timer));

        function renderHistory(history, elementId) {
            const container = document.getElementById(elementId);
            container.innerHTML = '';
            history.forEach(score => {
                const div = document.createElement('div');
                div.className = 'set-box';
                div.innerText = score;
                container.appendChild(div);
            });
        }
        function format(s) { return Math.floor(s/60).toString().padStart(2,'0') + ":" + (s%60).toString().padStart(2,'0'); }
    </script>
</body>
</html>
